#---------------------------------------------------#
## é…ç½®æ–‡ä»¶éœ€è¦æ”¾ç½®åœ¨ $HOME/.config/clash.meta/*.yaml

## è¿™ä»½æ–‡ä»¶æ˜¯clashXçš„åŸºç¡€é…ç½®æ–‡ä»¶ï¼Œè¯·å°½é‡æ–°å»ºé…ç½®æ–‡ä»¶è¿›è¡Œä¿®æ”¹ã€‚

## å¦‚æœæ‚¨ä¸çŸ¥é“å¦‚ä½•æ“ä½œï¼Œè¯·å‚é˜…
## Clash Meta wiki  https://docs.metacubex.one
## Clash Meta wiki  https://clash-meta.wiki
## Clash Meta Githubæ–‡æ¡£  https://github.com/MetaCubeX/Clash.Meta/blob/Alpha/README.md

#---------------------------------------------------#

# port: 7890 # HTTP(S) ä»£ç†æœåŠ¡å™¨ç«¯å£
# socks-port: 7891 # SOCKS5 ä»£ç†ç«¯å£
mixed-port: 10801 # HTTP(S) å’Œ SOCKS ä»£ç†æ··åˆç«¯å£
# redir-port: 7892 # é€æ˜ä»£ç†ç«¯å£ï¼Œç”¨äº Linux å’Œ MacOS

# Linux é€æ˜ä»£ç†æœåŠ¡å™¨ç«¯å£ï¼ˆTProxy TCP å’Œ TProxy UDPï¼‰
tproxy-port: 7893

allow-lan: true # å…è®¸å±€åŸŸç½‘è¿æ¥
bind-address: "*" # ç»‘å®š IP åœ°å€ï¼Œä»…ä½œç”¨äº allow-lan ä¸º trueï¼Œ'*'è¡¨ç¤ºæ‰€æœ‰åœ°å€

#  find-process-mode has 3 values:always, strict, off
#  - always, å¼€å¯ï¼Œå¼ºåˆ¶åŒ¹é…æ‰€æœ‰è¿›ç¨‹
#  - strict, é»˜è®¤ï¼Œç”± clash åˆ¤æ–­æ˜¯å¦å¼€å¯
#  - off, ä¸åŒ¹é…è¿›ç¨‹ï¼Œæ¨èåœ¨è·¯ç”±å™¨ä¸Šä½¿ç”¨æ­¤æ¨¡å¼
find-process-mode: strict

# è§„åˆ™åŒ¹é…æ¨¡å‹(rule/global/direct)
mode: rule

# GEOæ•°æ®æ¨¡å¼(æ›´æ”¹geoipä½¿ç”¨æ–‡ä»¶,mmdbæˆ–è€…dat,å¯é€‰true / flase,trueä¸ºdat,æ­¤é¡¹æœ‰é»˜è®¤å€¼flase)
geodata-mode: true
# GEOæ–‡ä»¶åŠ è½½æ¨¡å¼(standard: æ ‡å‡†åŠ è½½å™¨, memconservative: ä¸“ä¸ºå†…å­˜å—é™(å°å†…å­˜)è®¾å¤‡ä¼˜åŒ–çš„åŠ è½½å™¨(é»˜è®¤å€¼))
geodata-loader: standard
# è‡ªå®šä¹‰ geodata url
geox-url:
  geoip: https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geoip.dat
  geosite: https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geosite.dat
  mmdb: https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/country.mmdb

# æ—¥å¿—ç­‰çº§ silent/error/warning/info/debug
log-level: info

# å¼€å¯ IPv6 æ€»å¼€å…³ï¼Œå…³é—­é˜»æ–­æ‰€æœ‰ IPv6 é“¾æ¥å’Œå±è”½ DNS è¯·æ±‚ AAAA è®°å½•
ipv6: true

# RESTful API ç›‘å¬åœ°å€
external-controller: 0.0.0.0:9090
# API çš„è®¿é—®å¯†é’¥
secret: '123456'
# TCP å¹¶å‘è¿æ¥æ‰€æœ‰ IP, å°†ä½¿ç”¨æœ€å¿«æ¡æ‰‹çš„ TCP
tcp-concurrent: true
# é…ç½® WEB UI ç›®å½•ï¼Œä½¿ç”¨ http://{{external-controller}}/ui è®¿é—®
external-ui: "/etc/Clash-Meta/ui"

# å…¨å±€ TLS æŒ‡çº¹ï¼Œä¼˜å…ˆä½äº proxy å†…çš„ client-fingerprint
# å¯é€‰ï¼š "chrome","firefox","safari","ios","random","none" options.
# Utls is currently support TLS transport in TCP/grpc/WS/HTTP for VLESS/Vmess and trojan.
global-client-fingerprint: chrome

# ä¸º Linux ä¸‹çš„å‡ºç«™è¿æ¥æä¾›é»˜è®¤æµé‡æ ‡è®°
routing-mark: 2233

# ç¼“å­˜
profile:
  # å‚¨å­˜ API å¯¹ç­–ç•¥ç»„çš„é€‰æ‹©ï¼Œä»¥ä¾›ä¸‹æ¬¡å¯åŠ¨æ—¶ä½¿ç”¨
  store-selected: true
  # å‚¨å­˜ fakeip æ˜ å°„è¡¨ï¼ŒåŸŸåå†æ¬¡å‘ç”Ÿè¿æ¥æ—¶ï¼Œä½¿ç”¨åŸæœ‰æ˜ å°„åœ°å€
  store-fake-ip: true

# ç»Ÿä¸€å»¶è¿Ÿ, æ›´æ¢å»¶è¿Ÿè®¡ç®—æ–¹å¼,å»é™¤æ¡æ‰‹ç­‰é¢å¤–å»¶è¿Ÿ
unified-delay: false

#ã€Metaä¸“å±ã€‘snifferåŸŸåå—…æ¢å™¨
# å¼€å¯æ­¤åŠŸèƒ½ ä¼šå¯¼è‡´å¦‚æœä¸ä½¿ç”¨Clashå†…ç½®çš„DNSè§£ææœåŠ¡,å°±æ— æ³•å‡†ç¡®è¿˜åŸåŸŸå,è¿›è¡ŒåŸŸååˆ†æµçš„é—®é¢˜ã€‚
sniffer:
  enable: false                          # å—…æ¢å™¨å¼€å…³  
  sniff:
    TLS:                                # TLS é»˜è®¤å¦‚æœä¸é…ç½® ports é»˜è®¤å—…æ¢ 443
      ports: [443, 8443]
    HTTP:                               # éœ€è¦å—…æ¢çš„ç«¯å£, é»˜è®¤å—…æ¢ 80
      ports: [80, 8080-8880]
      override-destination: true        # æ˜¯å¦ä½¿ç”¨å—…æ¢ç»“æœä½œä¸ºå®é™…è®¿é—®,é»˜è®¤ true

tun:
  enable: true                          # æ˜¯å¦å¯ç”¨ tun æ¨¡å¼æ¥è·¯ç”±å…¨å±€æµé‡ã€‚
  stack: system                         # tun æ¨¡å¼å †æ ˆ,å¦‚æ— ä½¿ç”¨é—®é¢˜,å»ºè®®ä½¿ç”¨ system æ ˆ;MacOS ç”¨æˆ·æ¨è gvisoræ ˆ
  #dns-hijack:                           # dns åŠ«æŒ,ä¸€èˆ¬è®¾ç½®ä¸º any:53 å³å¯, å³åŠ«æŒæ‰€æœ‰ 53 ç«¯å£çš„ udp æµé‡
  #  - any:53
  #  - tcp://any:53
  auto-route: true                      # è‡ªåŠ¨è®¾ç½®å…¨å±€è·¯ç”±,å¯ä»¥è‡ªåŠ¨å°†å…¨å±€æµé‡è·¯ç”±è¿›å…¥ tun ç½‘å¡ã€‚
  auto-detect-interface: true           # è‡ªåŠ¨é€‰æ‹©æµé‡å‡ºå£æ¥å£,å¤šå‡ºå£ç½‘å¡åŒæ—¶è¿æ¥çš„è®¾å¤‡å»ºè®®æ‰‹åŠ¨æŒ‡å®šå‡ºå£ç½‘å¡

# ä½¿ç”¨ç³»ç»Ÿçš„dns, ä¹Ÿå°±æ˜¯dhcpæœåŠ¡å™¨ä¸‹å‘çš„dnsæœåŠ¡åœ°å€(ä½¿ç”¨æˆ‘è‡ªå»ºçš„dnsæœåŠ¡æ¥åˆ†æµ)
dns:
  enable: false                         # å…³é—­å°†ä½¿ç”¨ç³»ç»Ÿ DNS
  prefer-h3: true                       # å¼€å¯ DoH æ”¯æŒ HTTP/3ï¼Œå°†å¹¶å‘å°è¯•
  listen: 0.0.0.0:53                    # å¼€å¯ DNS æœåŠ¡å™¨ç›‘å¬
  ipv6: true                            # false å°†è¿”å› AAAA çš„ç©ºç»“æœ    
  ipv6-timeout: 300                     # å•ä½ï¼šmsï¼Œå†…éƒ¨åŒæ ˆå¹¶å‘æ—¶ï¼Œå‘ä¸Šæ¸¸æŸ¥è¯¢ AAAA æ—¶ï¼Œç­‰å¾… AAAA çš„æ—¶é—´ï¼Œé»˜è®¤ 100ms
  enhanced-mode: fake-ip                # or redir-host
  fake-ip-range: 28.0.0.1/8             # fake-ip æ± è®¾ç½®
  fake-ip-filter:
    - '*'
    - '+.lan'
    - '+.local'
  nameserver:
    - https://dns.alidns.com/dns-query
    - https://doh.pub/dns-query
  fallback:
    - https://1.1.1.1/dns-query
    - tcp://208.67.220.220:5353

proxies:
  - name: "ğŸ‡¸ğŸ‡¬ [vless-reality-vision] æ–°å®¶å¡-me"
    type: vless
    server: xxx
    port: xxx
    uuid: xxx
    network: tcp
    tls: true
    udp: true
    flow: xtls-rprx-vision
    servername: addons.mozilla.org
    reality-opts:
      public-key: "qhTzYYIgBzDLNYR79oxftqdo1kzL-1_hGJKfqrOliCY"
      short-id: 9ab288f7
    client-fingerprint: chrome

# æ¸¸æˆè§„åˆ™é›†ä¸‹è½½åœ°å€: https://github.com/FQrabbit/SSTap-Rule/
# å…¶å®ƒç¬¬ä¸‰æ–¹è§„åˆ™:
# 1. https://github.com/DivineEngine/Profiles/tree/master
# 2. https://github.com/dler-io/Rules
# 3. https://github.com/ACL4SSR/ACL4SSR/tree/master
rule-providers:
  # å®ˆæœ›å…ˆé”‹-äºšæœ
  overwatch:
    type: http
    behavior: ipcidr
    path: ./providers/Overwatch-Asia.rules
    #ã€Metaä¸“å±ã€‘URLå¯æ ¹æ®ruleè®¾å®šåŒ¹é…å¯¹åº”çš„ç­–ç•¥ï¼Œæ–¹ä¾¿æ›´æ–°provider
    url: "https://fastly.jsdelivr.net/gh/FQrabbit/SSTap-Rule@master/rules/Overwatch-Asia.rules"
    interval: 600
  # å®ˆæœ›å…ˆé”‹-äºšæœ
  LAN:
    type: http
    behavior: classical
    path: ./providers/LAN.yaml
    #ã€Metaä¸“å±ã€‘URLå¯æ ¹æ®ruleè®¾å®šåŒ¹é…å¯¹åº”çš„ç­–ç•¥ï¼Œæ–¹ä¾¿æ›´æ–°provider
    url: "https://fastly.jsdelivr.net/gh/dler-io/Rules@main/Clash/Provider/LAN.yaml"
    interval: 600
    
proxy-groups:
  - name: "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"
    type: select
    proxies:
      - "â™»ï¸ è‡ªåŠ¨é€‰æ‹©"
      - "ğŸ‡¸ğŸ‡¬ [vless-reality-vision] æ–°å®¶å¡-me"
      - DIRECT
  - name: "â™»ï¸ è‡ªåŠ¨é€‰æ‹©"
    type: url-test
    url: http://cp.cloudflare.com/generate_204
    interval: '180'
    tolerance: '100'
    proxies:
      - "ğŸ‡¸ğŸ‡¬ [vless-reality-vision] æ–°å®¶å¡-me"
  - name: â“‚ï¸ å¾®è½¯æœåŠ¡
    type: select
    proxies:
      - DIRECT
      - "ğŸ‡¸ğŸ‡¬ [vless-reality-vision] æ–°å®¶å¡-me"
  - name: "ğŸ è‹¹æœæœåŠ¡"
    type: select
    proxies:
      - DIRECT
      - "ğŸ‡¸ğŸ‡¬ [vless-reality-vision] æ–°å®¶å¡-me"
      - "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"
  - name: "ğŸ“º å“”å“©ä¸œå—äºš"
    type: select
    proxies:
      - DIRECT
      - "ğŸ‡¸ğŸ‡¬ [vless-reality-vision] æ–°å®¶å¡-me"
      - "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"
  - name: "ğŸŸ æ¼ç½‘ä¹‹é±¼"
    type: select
    proxies:
      - "â™»ï¸ è‡ªåŠ¨é€‰æ‹©"
      - "ğŸ‡¸ğŸ‡¬ [vless-reality-vision] æ–°å®¶å¡-me"
      - DIRECT
rules:
  # è‡ªå·±çš„è§„åˆ™æ”¾
  - DST-PORT,7893,REJECT
  - IP-CIDR,28.0.0.1/8,REJECT,no-resolve
  - IP-CIDR,0.0.0.0/32,REJECT,no-resolve
  - DOMAIN-SUFFIX,fillpit.top,DIRECT
  - DOMAIN-SUFFIX,fillpit.cn,DIRECT

  # å¸¸ç”¨å±€åŸŸç½‘ ip æ®µ ç›´è¿
  - RULE-SET,LAN,DIRECT

  # ******** è‡ªå®šä¹‰ è§„åˆ™åŒºåŸŸ start ********
  # ****** é»˜è®¤ éå›½å†…çš„åŸŸåå’Œipéƒ½èµ°ä»£ç† ******
  # ****** ä¹Ÿå°±æ˜¯è¯´åˆ†æµè§„åˆ™è¿™é‡Œä¸»è¦å…³æ³¨ éœ€è¦ç›´è¿çš„åœ°å€ å’Œéœ€è¦å±è”½çš„åœ°å€ (æ²¡åŒ¹é…ä¸Šçš„éƒ½èµ°ä»£ç†) ******

  # æµ‹é€Ÿç½‘ç«™ ç›´è¿
  - GEOSITE,speedtest,DIRECT
    # ç§æœ‰ç½‘ç»œä¸“ç”¨åŸŸå
  - GEOSITE,private,DIRECT
    # å“”å“©å“”å“© ç›´è¿
  - GEOSITE,bilibili,DIRECT
  # å¾®è½¯å®¶çš„æœåŠ¡ èµ°ä»£ç†
  - GEOSITE,microsoft,â“‚ï¸ å¾®è½¯æœåŠ¡
  # apple çš„æœåŠ¡
  - "GEOSITE,apple,ğŸ è‹¹æœæœåŠ¡"
  # telegram
  - GEOSITE,telegram,â™»ï¸ è‡ªåŠ¨é€‰æ‹©
  # å¨±ä¹ç±»
  - GEOSITE,category-entertainment,â™»ï¸ è‡ªåŠ¨é€‰æ‹©
  # å®ˆæœ›å…ˆé”‹-äºšæœ
  - RULE-SET,overwatch,â™»ï¸ è‡ªåŠ¨é€‰æ‹©

  # ******** è‡ªå®šä¹‰ è§„åˆ™åŒºåŸŸ end ********

  # å›½å†…åŸŸå ç›´è¿
  - GEOSITE,CN,DIRECT
  # å›½å†… ip ç›´è¿
  - GEOIP,CN,DIRECT
  # æ²¡åŒ¹é…ä¸Šçš„
  - DST-PORT,80,ğŸŸ æ¼ç½‘ä¹‹é±¼
  - DST-PORT,443,ğŸŸ æ¼ç½‘ä¹‹é±¼
  - DST-PORT,22,ğŸŸ æ¼ç½‘ä¹‹é±¼
  - MATCH,DIRECT